{{- if .Values.otelEnvironmentVariableSecrets.enabled }}
{{- $serviceName := include "ark-cluster-memory.fullname" . }}
{{- $serviceNamespace := .Release.Namespace }}
{{- $endpoint := printf "http://%s.%s.svc.cluster.local:%v" $serviceName $serviceNamespace (.Values.service.port | int) }}
{{- range .Values.otelEnvironmentVariableSecrets.namespaces }}
---
apiVersion: v1
kind: Secret
metadata:
  name: otel-environment-variables
  namespace: {{ . }}
  labels:
    app.kubernetes.io/name: {{ $.Chart.Name }}
    app.kubernetes.io/managed-by: {{ $.Release.Service }}
type: Opaque
stringData:
  OTEL_EXPORTER_OTLP_ENDPOINT: {{ $endpoint }}
  OTEL_EXPORTER_OTLP_HEADERS: ""
{{- end }}
{{- end }}
