# ARK MCP chart values

# Global annotations added to all resources
global:
  annotations:
    ark.mckinsey.com/service: ark-mcp

# Application configuration
app:
  name: ark-mcp
  image:
    repository: ghcr.io/mckinsey/agents-at-scale-ark/ark-mcp
    # tag defaults to .Chart.AppVersion if not specified
    pullPolicy: IfNotPresent
  
  # Resource configuration
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"

  # L2 FIX: Pod security context for hardening
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1001
    fsGroup: 1001
    seccompProfile:
      type: RuntimeDefault

  # L2 FIX: Container security context for hardening
  securityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop:
        - ALL

# Service configuration
service:
  name: ark-mcp
  type: ClusterIP
  port: 80
  targetPort: 2627

# Ingress configuration (legacy routing method)
# Disabled by default. Use this for traditional Kubernetes Ingress routing.
# For newer deployments, consider using HTTPRoute (below) with Gateway API instead.
ingress:
  enabled: false
  className: ""  # e.g., "nginx", "traefik", "kong"
  annotations:
    # Security headers for clickjacking protection (M1) and general hardening (L3)
    nginx.ingress.kubernetes.io/configuration-snippet: |
      more_set_headers "X-Frame-Options: DENY";
      more_set_headers "Content-Security-Policy: frame-ancestors 'none'";
      more_set_headers "X-Content-Type-Options: nosniff";
      more_set_headers "X-XSS-Protection: 1; mode=block";
      more_set_headers "Strict-Transport-Security: max-age=31536000; includeSubDomains";
      more_set_headers "Referrer-Policy: strict-origin-when-cross-origin";
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: ark-mcp.example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: ark-mcp-tls
  #    hosts:
  #      - ark-mcp.example.local

# HTTPRoute configuration (Gateway API - modern routing method)
# Disabled by default. This is the preferred routing method for Kubernetes 1.23+
# with Gateway API CRDs installed. Example values below show localhost development setup.
httpRoute:
  enabled: false
  annotations: {}
    # Custom annotations can be added here
  # Gateway references
  parentRefs:
    - name: localhost-gateway
      namespace: ark-system
  # Hostnames this route matches
  hostnames:
    - "ark-mcp.default.127.0.0.1.nip.io"

# Service account configuration
serviceAccount:
  name: ark-mcp-sa
  create: true
