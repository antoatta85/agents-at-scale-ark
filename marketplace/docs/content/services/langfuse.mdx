---
title: Langfuse
description: Open-source LLM observability and analytics platform
---

# Langfuse

[Langfuse](https://langfuse.com/docs) is an open-source LLM observability and analytics platform that provides comprehensive tracing, monitoring, and analytics for AI applications. Self-hosted deployment with PostgreSQL, ClickHouse, and Redis.

## Overview

Langfuse integration with ARK provides:

- **LLM Call Tracing**: Track all model interactions and API calls
- **Cost Monitoring**: Monitor API usage and associated costs
- **Performance Analytics**: Response times, throughput, and latency metrics
- **Session Management**: Group related interactions and conversations
- **Error Tracking**: Identify and debug issues in agent workflows
- **Multi-namespace Support**: OTEL environment variables automatically configured

## Quick Start

### Installation

**Using DevSpace (Recommended for Development):**
```bash
cd marketplace/services/langfuse
devspace deploy
```

**Using Helm:**
```bash
cd marketplace/services/langfuse
helm repo add langfuse https://langfuse.github.io/langfuse-k8s
helm dependency update chart/
helm install langfuse ./chart -n telemetry --create-namespace
```

### Access Dashboard

**With DevSpace:**
```bash
cd marketplace/services/langfuse
devspace dev
# Dashboard automatically available at http://localhost:3000
```

**Login Credentials:**
- **Username**: `ark@ark.com`
- **Password**: `password123`

**With kubectl:**
```bash
kubectl port-forward -n telemetry svc/langfuse-web 3000:3000
# Open http://localhost:3000
```

## Configuration

### Default Configuration

Langfuse is deployed with these defaults:
- **Namespace**: `telemetry`
- **Service Name**: `langfuse-web`
- **Port**: `3000`
- **OTEL Endpoint**: `http://langfuse-web.telemetry.svc.cluster.local:3000/api/public/otel`
- **Organization**: `ark`
- **Project**: `ark`

### Headless Initialization

Langfuse is automatically pre-configured with:
- **User**: `ark@ark.com` / `password123`
- **Public Key**: `lf_pk_1234567890`
- **Secret Key**: `lf_sk_1234567890`
- **API Keys**: Pre-configured for OpenTelemetry integration

### OTEL Environment Variables

Langfuse automatically creates Kubernetes secrets with OTEL environment variables in configured namespaces (default: `ark-system` and `default`).

The secret `otel-environment-variables` contains:
```yaml
OTEL_EXPORTER_OTLP_ENDPOINT: http://langfuse-web.telemetry.svc.cluster.local:3000/api/public/otel
OTEL_EXPORTER_OTLP_HEADERS: Authorization=Basic <base64-encoded-credentials>
```

### Using OTEL Secrets in Deployments

Add to your deployment's container spec:
```yaml
envFrom:
  - secretRef:
      name: otel-environment-variables
      optional: true
```

**Note**: Existing deployments must be restarted to pick up new/updated secrets:
```bash
kubectl rollout restart deployment/ark-controller-devspace -n ark-system
```

### Custom Configuration

Customize Langfuse by modifying `chart/values.yaml`:

```yaml
# Enable HTTPRoute for Gateway API routing
httpRoute:
  enabled: true
  hostnames:
    - "langfuse.example.com"

# Add OTEL secrets to additional namespaces
otelEnvironmentVariableSecrets:
  enabled: true
  namespaces:
    - ark-system
    - default
    - my-custom-namespace

# Configure demo project credentials
demo:
  project:
    publicKey: lf_pk_1234567890
    secretKey: lf_sk_1234567890

# Configure Langfuse settings
langfuse:
  service:
    type: LoadBalancer  # Expose externally
```

## Using Langfuse Dashboard

### Dashboard Overview

Once logged in, the Langfuse dashboard provides:

**Traces View**
- Complete execution traces for ARK operations
- Model calls and responses
- Timing and performance metrics

**Sessions View**
- Grouped interactions and conversations
- Session-level analytics

**Models View**
- Model usage statistics
- Cost breakdown by model
- Performance comparisons

### Viewing ARK Traces

After installation and configuration, Langfuse will collect traces from ARK components:

Traces include:
- Controller startup events
- Query execution flows
- Model inference calls
- Tool executions
- Agent interactions

## Troubleshooting

### Dashboard Not Accessible

Check if Langfuse is running:
```bash
kubectl get pods -l app=langfuse -n telemetry
kubectl get svc -n telemetry
```

Verify port-forwarding:
```bash
kubectl port-forward -n telemetry svc/langfuse-web 3000:3000
```

### Login Issues

If you can't log in with the default credentials:
- Ensure the deployment completed successfully
- Check the demo project configuration in `values.yaml`
- Review Langfuse logs for initialization errors:
  ```bash
  kubectl logs -l app=langfuse -n telemetry
  ```

### No Traces Appearing

1. Verify OTEL endpoint is configured correctly
2. Check that applications are instrumented with OpenTelemetry
3. Ensure OTEL secrets are mounted in your deployments
4. Restart deployments after updating secrets:
   ```bash
   kubectl rollout restart deployment/ark-controller-devspace -n ark-system
   ```
5. Check telemetry initialization logs:
   ```bash
   kubectl logs deployment/ark-controller -n ark-system | grep telemetry
   ```

### OTEL Secrets Not Created

Check if the secret exists:
```bash
kubectl get secret otel-environment-variables -n ark-system
```

If missing, verify `otelEnvironmentVariableSecrets.enabled: true` in `values.yaml` and redeploy.

### Service Connectivity Issues

Test connectivity from within the cluster:
```bash
kubectl exec -it <ark-controller-pod> -n ark-system -- \
  curl http://langfuse-web.telemetry.svc.cluster.local:3000/health
```

## Gateway API Access

Langfuse can be configured with Gateway API HTTPRoute for namespace-based access:

```bash
# Access via nip.io DNS pattern (if HTTPRoute is enabled)
open http://langfuse.telemetry.127.0.0.1.nip.io:8080
```

**Note**: HTTPRoute is disabled by default in DevSpace. To enable it, update `chart/values.yaml`:

```yaml
httpRoute:
  enabled: true
  parentRefs:
    - name: localhost-gateway
      namespace: ark-system
  hostnames:
    - "langfuse.telemetry.127.0.0.1.nip.io"
```

Then redeploy Langfuse:

```bash
devspace purge
devspace deploy
```

## Uninstallation

**Using DevSpace:**
```bash
cd marketplace/services/langfuse
devspace purge
```

**Using Helm:**
```bash
helm uninstall langfuse -n telemetry
kubectl delete namespace telemetry  # Optional: remove namespace
```

**Note**: OTEL environment variable secrets in other namespaces are not automatically removed. To clean them up:

```bash
kubectl delete secret otel-environment-variables -n ark-system
kubectl delete secret otel-environment-variables -n default
```

## Additional Resources

- [Langfuse Documentation](https://langfuse.com/docs)
- [Langfuse Kubernetes Deployment](https://langfuse.com/docs/deployment/k8s)
- [OpenTelemetry Documentation](https://opentelemetry.io/docs/)
